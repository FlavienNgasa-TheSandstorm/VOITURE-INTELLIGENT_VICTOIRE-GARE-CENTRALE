<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulation - Agent V√©hicule</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        .simulation-hero {
            background: var(--gradient-primary);
            color: white;
            padding: 140px 0 80px;
            text-align: center;
            margin-top: 80px;
            position: relative;
            overflow: hidden;
        }

        .simulation-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80');
            background-size: cover;
            background-position: center;
            opacity: 0.1;
        }

        .simulation-container {
            padding: 80px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Carte de simulation */
        .simulation-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 50px;
            box-shadow: var(--shadow);
            margin-bottom: 50px;
            position: relative;
            overflow: hidden;
        }

        .simulation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .panel-title {
            text-align: center;
            margin-bottom: 40px;
        }

        .panel-title h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 700;
        }

        .panel-title p {
            font-size: 1.2rem;
            color: var(--text-light);
        }

        /* Route zigzagante */
        .road-container {
            position: relative;
            height: 500px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            margin: 40px 0;
            overflow: hidden;
            border: 2px solid #e9ecef;
        }

        .road {
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Chemin zigzag */
        .zigzag-path {
            position: absolute;
            top: 50%;
            left: 5%;
            right: 5%;
            height: 4px;
            background: var(--accent);
            transform: translateY(-50%);
        }

        .zigzag-path::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 20px,
                white 20px,
                white 40px
            );
            transform: translateY(-50%);
        }

        /* Points de contr√¥le pour le zigzag */
        .path-point {
            position: absolute;
            top: 50%;
            width: 10px;
            height: 10px;
            background: var(--accent);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .path-point:nth-child(1) { left: 10%; top: 30%; }
        .path-point:nth-child(2) { left: 25%; top: 60%; }
        .path-point:nth-child(3) { left: 40%; top: 35%; }
        .path-point:nth-child(4) { left: 55%; top: 65%; }
        .path-point:nth-child(5) { left: 70%; top: 40%; }
        .path-point:nth-child(6) { left: 85%; top: 55%; }

        /* V√©hicule */
        .car {
            position: absolute;
            top: 30%;
            left: 5%;
            font-size: 3.5rem;
            color: var(--secondary);
            z-index: 20;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.3));
            transition: all 2s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translate(-50%, -50%);
        }

        /* Points d'arr√™t */
        .route-point {
            position: absolute;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 15;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            border: 2px solid;
            min-width: 160px;
            transition: var(--transition);
        }

        .route-point:hover {
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: var(--shadow-hover);
        }

        .route-point.start {
            border-color: var(--success);
            background: rgba(39, 174, 96, 0.05);
        }

        .route-point.end {
            border-color: var(--secondary);
            background: rgba(231, 76, 60, 0.05);
        }

        .route-point.intermediate {
            border-color: var(--accent);
            background: rgba(52, 152, 219, 0.05);
        }

        .route-point.bus-stop {
            border-color: var(--warning);
            background: rgba(243, 156, 18, 0.05);
        }

        .route-point i {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .route-point .point-name {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .route-point .point-type {
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 500;
        }

        /* Positions des points */
        .route-point.start { left: 5%; top: 30%; }
        .route-point.intermediate:nth-of-type(2) { left: 25%; top: 60%; }
        .route-point.bus-stop:nth-of-type(3) { left: 40%; top: 35%; }
        .route-point.intermediate:nth-of-type(4) { left: 55%; top: 65%; }
        .route-point.bus-stop:nth-of-type(5) { left: 70%; top: 40%; }
        .route-point.end { left: 85%; top: 55%; }

        /* Contr√¥les */
        .controls-panel {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
        }

        .strategy-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .strategy-btn {
            padding: 25px 20px;
            border: 2px solid #e8e8e8;
            border-radius: 15px;
            background: white;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            font-weight: 600;
        }

        .strategy-btn:hover {
            border-color: var(--accent);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(52, 152, 219, 0.2);
        }

        .strategy-btn.active {
            border-color: var(--accent);
            background: var(--accent);
            color: white;
            box-shadow: 0 10px 30px rgba(52, 152, 219, 0.3);
        }

        .strategy-btn i {
            font-size: 2rem;
        }

        .simulation-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .btn-large {
            padding: 18px 35px;
            font-size: 1.1rem;
        }

        /* Statistiques */
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px 25px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            text-align: center;
            border-left: 4px solid var(--accent);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.95rem;
            font-weight: 500;
        }

        /* Informations */
        .info-panel {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            box-shadow: var(--shadow);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
        }

        .info-card {
            text-align: center;
            padding: 30px 25px;
            background: var(--light);
            border-radius: 15px;
            transition: var(--transition);
        }

        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        .info-card i {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 20px;
        }

        .info-card h4 {
            margin-bottom: 15px;
            color: var(--primary);
            font-size: 1.3rem;
        }

        .info-card p {
            color: var(--text-light);
            line-height: 1.6;
        }

        /* Animation d'attente */
        .waiting-animation {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 25px 35px;
            border-radius: 15px;
            box-shadow: var(--shadow-hover);
            z-index: 25;
            text-align: center;
            border: 2px solid var(--warning);
        }

        .waiting-animation i {
            font-size: 2.5rem;
            color: var(--warning);
            margin-bottom: 15px;
            display: block;
        }

        /* Responsive */
        @media (max-width: 968px) {
            .road-container {
                height: 400px;
            }
            
            .car {
                font-size: 3rem;
            }
            
            .route-point {
                min-width: 140px;
                padding: 15px;
            }
        }

        @media (max-width: 768px) {
            .simulation-container {
                padding: 60px 15px;
            }
            
            .road-container {
                height: 300px;
            }
            
            .car {
                font-size: 2.5rem;
            }
            
            .strategy-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .simulation-controls {
                flex-direction: column;
            }
            
            .stats-panel {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .route-point {
                min-width: 120px;
                padding: 12px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .stats-panel {
                grid-template-columns: 1fr;
            }
            
            .strategy-buttons {
                grid-template-columns: 1fr;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .route-point {
                min-width: 100px;
                padding: 10px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <i class="fas fa-car"></i>
                <span>Agent V√©hicule</span>
            </a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link"><i class="fas fa-home"></i> Accueil</a></li>
                <li><a href="simulation.html" class="nav-link active"><i class="fas fa-play"></i> Simulation</a></li>
                <li><a href="apropos.html" class="nav-link"><i class="fas fa-info-circle"></i> √Ä Propos</a></li>
                <li><a href="generation.html" class="nav-link"><i class="fas fa-cogs"></i> G√©n√©ration</a></li>
            </ul>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- En-t√™te Simulation -->
    <section class="simulation-hero">
        <div class="container">
            <h1 class="hero-title">Simulation en Temps R√©el</h1>
            <p class="hero-description">Visualisation du trajet zigzagant Place de la Victoire ‚Üí Gare Centrale</p>
        </div>
    </section>

    <!-- Contenu Simulation -->
    <div class="simulation-container">
        <!-- Carte de simulation -->
        <div class="simulation-card">
            <div class="panel-title">
                <h2>Simulation du Trajet</h2>
                <p>Suivez le v√©hicule √† travers les rues de Kinshasa</p>
            </div>

            <!-- Route zigzagante -->
            <div class="road-container">
                <div class="road">
                    <!-- Points de chemin -->
                    <div class="path-point"></div>
                    <div class="path-point"></div>
                    <div class="path-point"></div>
                    <div class="path-point"></div>
                    <div class="path-point"></div>
                    <div class="path-point"></div>

                    <!-- V√©hicule -->
                    <div class="car" id="car">
                        <i class="fas fa-car"></i>
                    </div>

                    <!-- Points d'arr√™t -->
                    <div class="route-point start">
                        <i class="fas fa-play-circle"></i>
                        <div class="point-name">Place Victoire</div>
                        <div class="point-type">D√©part</div>
                    </div>

                    <div class="route-point intermediate">
                        <i class="fas fa-building"></i>
                        <div class="point-name">March√© Central</div>
                        <div class="point-type">Point interm√©diaire</div>
                    </div>

                    <div class="route-point bus-stop">
                        <i class="fas fa-bus"></i>
                        <div class="point-name">Arr√™t Victoire</div>
                        <div class="point-type">Arr√™t de bus</div>
                    </div>

                    <div class="route-point intermediate">
                        <i class="fas fa-university"></i>
                        <div class="point-name">Place du 30 Juin</div>
                        <div class="point-type">Point interm√©diaire</div>
                    </div>

                    <div class="route-point bus-stop">
                        <i class="fas fa-bus"></i>
                        <div class="point-name">Arr√™t Gare</div>
                        <div class="point-type">Arr√™t de bus</div>
                    </div>

                    <div class="route-point end">
                        <i class="fas fa-flag-checkered"></i>
                        <div class="point-name">Gare Centrale</div>
                        <div class="point-type">Arriv√©e</div>
                    </div>

                    <!-- Animation d'attente -->
                    <div class="waiting-animation" id="waitingAnimation">
                        <i class="fas fa-clock"></i>
                        <div style="font-weight: 600; margin-bottom: 5px;">Arr√™t √† l'arr√™t de bus</div>
                        <div style="color: var(--text-light); font-size: 0.9rem;">D√©part dans <span id="countdown">5</span>s</div>
                    </div>
                </div>
            </div>

            <!-- Contr√¥les -->
            <div class="controls-panel">
                <div class="strategy-buttons">
                    <button class="strategy-btn active" data-strategy="rapide">
                        <i class="fas fa-bolt"></i>
                        <span>Rapide</span>
                    </button>
                    <button class="strategy-btn" data-strategy="economique">
                        <i class="fas fa-dollar-sign"></i>
                        <span>√âconomique</span>
                    </button>
                    <button class="strategy-btn" data-strategy="securise">
                        <i class="fas fa-shield-alt"></i>
                        <span>S√©curis√©e</span>
                    </button>
                    <button class="strategy-btn" data-strategy="confort">
                        <i class="fas fa-couch"></i>
                        <span>Confort</span>
                    </button>
                </div>

                <div class="simulation-controls">
                    <button id="startSimulation" class="btn btn-primary btn-large">
                        <i class="fas fa-play"></i>
                        D√©marrer la Simulation
                    </button>
                    <button id="pauseSimulation" class="btn btn-outline btn-large" style="display: none;">
                        <i class="fas fa-pause"></i>
                        Pause
                    </button>
                    <button id="resetSimulation" class="btn btn-secondary btn-large">
                        <i class="fas fa-redo"></i>
                        R√©initialiser
                    </button>
                </div>

                <!-- Statistiques -->
                <div class="stats-panel">
                    <div class="stat-card">
                        <div class="stat-value" id="distanceValue">0.0 km</div>
                        <div class="stat-label">Distance parcourue</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="timeValue">0 min</div>
                        <div class="stat-label">Temps √©coul√©</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="speedValue">0 km/h</div>
                        <div class="stat-label">Vitesse moyenne</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="progressValue">0%</div>
                        <div class="stat-label">Progression</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Informations -->
        <div class="info-panel">
            <h3 style="text-align: center; margin-bottom: 40px; color: var(--primary); font-size: 2rem;">Informations du Trajet</h3>
            <div class="info-grid">
                <div class="info-card">
                    <i class="fas fa-map-marker-alt"></i>
                    <h4>Point de D√©part</h4>
                    <p>Place de la Victoire, Kalamu<br>Point de d√©part historique et symbolique</p>
                </div>
                <div class="info-card">
                    <i class="fas fa-flag"></i>
                    <h4>Point d'Arriv√©e</h4>
                    <p>Gare Centrale, Gombe<br>Destination finale et hub transport</p>
                </div>
                <div class="info-card">
                    <i class="fas fa-route"></i>
                    <h4>Type de Trajet</h4>
                    <p id="currentStrategy">Rapide<br>Trajet optimis√© pour la vitesse</p>
                </div>
                <div class="info-card">
                    <i class="fas fa-road"></i>
                    <h4>Distance Totale</h4>
                    <p>~12.5 km<br>Trajet avec arr√™ts interm√©diaires</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Agent V√©hicule Intelligent</h3>
                    <p>Syst√®me de simulation avanc√© pour optimiser les d√©placements √† Kinshasa. Projet acad√©mique d√©montrant l'intelligence artificielle appliqu√©e aux transports.</p>
                </div>
                <div class="footer-section">
                    <h4>Navigation</h4>
                    <ul>
                        <li><a href="index.html"><i class="fas fa-chevron-right"></i> Accueil</a></li>
                        <li><a href="simulation.html"><i class="fas fa-chevron-right"></i> Simulation</a></li>
                        <li><a href="apropos.html"><i class="fas fa-chevron-right"></i> √Ä Propos</a></li>
                        <li><a href="generation.html" class="nav-link"><i class="fas fa-cogs"></i> G√©n√©ration</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <ul>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Universit√© de Kinshasa</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> Facult√© des Sciences</a></li>
                        <li><a href="#"><i class="fas fa-chevron-right"></i> G√©nie Logiciel L3</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Agent V√©hicule Intelligent - Projet Acad√©mique - Universit√© de Kinshasa</p>
            </div>
        </div>
    </footer>

    <script>
        class SimulationManager {
            constructor() {
                this.car = document.getElementById('car');
                this.waitingAnimation = document.getElementById('waitingAnimation');
                this.countdownElement = document.getElementById('countdown');
                
                this.isRunning = false;
                this.isPaused = false;
                this.currentStrategy = 'rapide';
                this.progress = 0;
                this.animationId = null;
                this.currentStop = null;
                
                // Points de chemin pour le zigzag (x, y en pourcentage)
                this.pathPoints = [
                    { x: 5, y: 30 },   // D√©part
                    { x: 25, y: 60 },  // Point 1
                    { x: 40, y: 35 },  // Point 2
                    { x: 55, y: 65 },  // Point 3
                    { x: 70, y: 40 },  // Point 4
                    { x: 85, y: 55 }   // Arriv√©e
                ];

                this.stops = [
                    { pointIndex: 1, type: 'intermediate', name: 'March√© Central', duration: 2000 },
                    { pointIndex: 2, type: 'bus_stop', name: 'Arr√™t Victoire', duration: 5000 },
                    { pointIndex: 3, type: 'intermediate', name: 'Place du 30 Juin', duration: 2000 },
                    { pointIndex: 4, type: 'bus_stop', name: 'Arr√™t Gare', duration: 5000 }
                ];

                this.currentPointIndex = 0;
                this.init();
            }

            init() {
                // Strat√©gies
                document.querySelectorAll('.strategy-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.strategy-btn').forEach(b => b.classList.remove('active'));
                        e.currentTarget.classList.add('active');
                        this.currentStrategy = e.currentTarget.dataset.strategy;
                        document.getElementById('currentStrategy').textContent = this.getStrategyName(this.currentStrategy);
                    });
                });

                // Contr√¥les
                document.getElementById('startSimulation').addEventListener('click', () => {
                    this.startSimulation();
                });

                document.getElementById('pauseSimulation').addEventListener('click', () => {
                    this.pauseSimulation();
                });

                document.getElementById('resetSimulation').addEventListener('click', () => {
                    this.resetSimulation();
                });

                this.updateCarPosition();
            }

            getStrategyName(strategy) {
                const names = {
                    'rapide': 'Rapide - Trajet direct',
                    'economique': '√âconomique - Co√ªt r√©duit', 
                    'securise': 'S√©curis√©e - Voies principales',
                    'confort': 'Confort - Peu d\'arr√™ts'
                };
                return names[strategy] || 'Rapide - Trajet direct';
            }

            startSimulation() {
                if (this.isRunning) return;
                
                this.isRunning = true;
                this.isPaused = false;
                this.currentPointIndex = 0;
                
                document.getElementById('startSimulation').style.display = 'none';
                document.getElementById('pauseSimulation').style.display = 'inline-block';
                
                this.moveToNextPoint();
            }

            moveToNextPoint() {
                if (this.currentPointIndex >= this.pathPoints.length - 1) {
                    this.completeSimulation();
                    return;
                }

                const currentPoint = this.pathPoints[this.currentPointIndex];
                const nextPoint = this.pathPoints[this.currentPointIndex + 1];
                
                // V√©rifier s'il y a un arr√™t √† ce point
                const stop = this.stops.find(s => s.pointIndex === this.currentPointIndex);
                
                if (stop && !stop.visited) {
                    this.handleStop(stop);
                    return;
                }

                const duration = this.getMoveDuration();
                
                this.animateCarToPoint(nextPoint, duration, () => {
                    this.currentPointIndex++;
                    this.progress = (this.currentPointIndex / (this.pathPoints.length - 1)) * 100;
                    this.updateStats();
                    
                    if (this.isRunning) {
                        setTimeout(() => this.moveToNextPoint(), 500);
                    }
                });
            }

            animateCarToPoint(targetPoint, duration, callback) {
                const startPoint = this.pathPoints[this.currentPointIndex];
                const startTime = performance.now();
                
                const animate = (currentTime) => {
                    if (this.isPaused) {
                        this.animationId = requestAnimationFrame(animate);
                        return;
                    }
                    
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // Interpolation cubique pour un mouvement smooth
                    const easeProgress = this.cubicEaseInOut(progress);
                    
                    const currentX = startPoint.x + (targetPoint.x - startPoint.x) * easeProgress;
                    const currentY = startPoint.y + (targetPoint.y - startPoint.y) * easeProgress;
                    
                    this.car.style.left = `${currentX}%`;
                    this.car.style.top = `${currentY}%`;
                    
                    if (progress < 1) {
                        this.animationId = requestAnimationFrame(animate);
                    } else {
                        callback();
                    }
                };
                
                this.animationId = requestAnimationFrame(animate);
            }

            cubicEaseInOut(t) {
                return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
            }

            getMoveDuration() {
                const durations = {
                    'rapide': 2000,
                    'economique': 3000,
                    'securise': 2500,
                    'confort': 3500
                };
                return durations[this.currentStrategy] || 2500;
            }

            handleStop(stop) {
                this.currentStop = stop;
                this.isPaused = true;
                
                this.waitingAnimation.style.display = 'block';
                this.waitingAnimation.style.left = `${this.pathPoints[stop.pointIndex].x}%`;
                this.waitingAnimation.style.top = `${this.pathPoints[stop.pointIndex].y}%`;
                
                if (stop.type === 'bus_stop') {
                    let countdown = 5;
                    this.countdownElement.textContent = countdown;
                    
                    const countdownInterval = setInterval(() => {
                        countdown--;
                        this.countdownElement.textContent = countdown;
                        
                        if (countdown <= 0) {
                            clearInterval(countdownInterval);
                            this.resumeFromStop(stop);
                        }
                    }, 1000);
                } else {
                    setTimeout(() => {
                        this.resumeFromStop(stop);
                    }, stop.duration);
                }
            }

            resumeFromStop(stop) {
                this.waitingAnimation.style.display = 'none';
                stop.visited = true;
                this.currentStop = null;
                this.isPaused = false;
                
                this.currentPointIndex++;
                this.progress = (this.currentPointIndex / (this.pathPoints.length - 1)) * 100;
                this.updateStats();
                this.updateCarPosition();
                
                if (this.isRunning) {
                    setTimeout(() => this.moveToNextPoint(), 500);
                }
            }

            updateCarPosition() {
                const point = this.pathPoints[this.currentPointIndex];
                this.car.style.left = `${point.x}%`;
                this.car.style.top = `${point.y}%`;
            }

            updateStats() {
                const distance = (12.5 * this.progress / 100).toFixed(1);
                const time = Math.floor(this.progress * 0.3); // Ajust√© pour √™tre plus r√©aliste
                const speed = 20 + (this.progress / 4); // Vitesse plus r√©aliste
                
                document.getElementById('distanceValue').textContent = `${distance} km`;
                document.getElementById('timeValue').textContent = `${time} min`;
                document.getElementById('speedValue').textContent = `${Math.round(speed)} km/h`;
                document.getElementById('progressValue').textContent = `${Math.min(100, Math.floor(this.progress))}%`;
            }

            pauseSimulation() {
                this.isPaused = !this.isPaused;
                
                if (this.isPaused) {
                    document.getElementById('pauseSimulation').innerHTML = '<i class="fas fa-play"></i> Reprendre';
                } else {
                    document.getElementById('pauseSimulation').innerHTML = '<i class="fas fa-pause"></i> Pause';
                    this.moveToNextPoint();
                }
            }

            resetSimulation() {
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }
                
                this.isRunning = false;
                this.isPaused = false;
                this.progress = 0;
                this.currentPointIndex = 0;
                this.currentStop = null;
                
                this.stops.forEach(stop => stop.visited = false);
                this.waitingAnimation.style.display = 'none';
                
                document.getElementById('startSimulation').style.display = 'inline-block';
                document.getElementById('pauseSimulation').style.display = 'none';
                document.getElementById('pauseSimulation').innerHTML = '<i class="fas fa-pause"></i> Pause';
                
                this.updateCarPosition();
                this.updateStats();
            }

            completeSimulation() {
                this.isRunning = false;
                this.progress = 100;
                this.updateStats();
                
                setTimeout(() => {
                    alert('üéâ Simulation termin√©e ! Le v√©hicule est arriv√© √† la Gare Centrale.');
                    this.resetSimulation();
                }, 1000);
            }
        }

        // D√©marrer la simulation
        document.addEventListener('DOMContentLoaded', () => {
            new SimulationManager();
        });
    </script>
</body>
</html>